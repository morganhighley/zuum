<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_TPSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Dynamic Updates to User Attributes</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/TP-Global-Styles.css" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../Resources/Stylesheets/TP-Global-Table-Styles.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script type="text/javascript" src="../../Skins/Default/Scripts/TPSkin-TopicToolbar.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="http://www.crestron.com" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="padding">
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                            </div>
                                        </div>
                                        <div role="main" id="mc-main-content">
                                            <h1>Dynamic Updates to User Attributes</h1>
                                            <p>This topic describes how to create dynamic updates to user attributes for a Crestron Driver.  If a driver supports runtime updates to user attributes such as add, remove or update, then the driver must have a way to notify the applications about these changes. IBasicInformation3 is an interface that supports this functionality.</p>
                                            <p>The IBasicInformation3 inherits IBasicInformation2, which has support for updating user attributes from applications.</p>
                                            <p>Refer to the following code.</p>
                                            <p class="codeboxshade">public interface IBasicInformation3 : IBasicInformation2<br />{<br /><span class="indent">/// &lt;summary&gt;<br />/// Event to notify user attributes changes.<br />/// &lt;/summary&gt;<br />event EventHandler&lt;UserAttributeListEventArgs&gt; UserAttributesChanged;</span>}</p>
                                            <p>&#160;</p>
                                            <p class="codeboxshade">public interface IBasicInformation2<br />{<br /><span class="indent">/// &lt;summary&gt;<br />/// Sets a user attribute to the specified value.<br />/// &lt;/summary&gt;<br />/// &lt;param name="attributeId"&gt;The attribute ID specified by UserAttribute.ParameterId&lt;/param&gt;<br />/// &lt;param name="attributeValue"&gt;The value this attribute should be set to&lt;/param&gt;<br />void SetUserAttribute(string attributeId, string attributeValue);<br /><br />/// &lt;summary&gt;<br />/// Sets a user attribute to the specified value.<br />/// &lt;/summary&gt;<br />/// &lt;param name="attributeId"&gt;The attribute ID specified by UserAttribute.ParameterId&lt;/param&gt;<br />/// &lt;param name="attributeValue"&gt;The value this attribute should be set to&lt;/param&gt;<br />void SetUserAttribute(string attributeId, ushort attributeValue);<br /><br />/// &lt;summary&gt;<br />/// Sets a user attribute to the specified value.<br />/// &lt;/summary&gt;<br />/// &lt;param name="attributeId"&gt;The attribute ID specified by UserAttribute.ParameterId&lt;/param&gt;<br />/// &lt;param name="attributeValue"&gt;The value this attribute should be set to&lt;/param&gt;<br />void SetUserAttribute(string attributeId, bool attributeValue);<br /><br />/// &lt;summary&gt;<br />/// Retrieves a list of all User Attributes the current driver supports<br />/// &lt;/summary&gt;<br />/// &lt;returns&gt;&lt;/returns&gt;<br />List&lt;UserAttribute&gt; RetrieveUserAttributes();</span>}</p>
                                            <p>If the main driver class inherits the ABasicDriver class, then it gets the support IBasicInformation3 functionality. ABasicDriver has functionality to add, remove, and update user attributes. ABasicDriver raises an event notification to applications when there is a change to a user attribute.</p>
                                            <p>The following methods are provided for ABasicInformation3:</p>
                                            <table style="mc-table-style: url('../Resources/Stylesheets/TP-Global-Table-Styles.css');" class="TableStyle-TP-Global-Table-Styles" cellspacing="0">
                                                <col class="TableStyle-TP-Global-Table-Styles-Column-Column1" />
                                                <col class="TableStyle-TP-Global-Table-Styles-Column-Column1" />
                                                <thead>
                                                    <tr class="TableStyle-TP-Global-Table-Styles-Head-Header1">
                                                        <th class="TableStyle-TP-Global-Table-Styles-HeadE-Column1-Header1" style="text-align: left;">Method</th>
                                                        <th class="TableStyle-TP-Global-Table-Styles-HeadD-Column1-Header1" style="text-align: left;">Description and Use</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="TableStyle-TP-Global-Table-Styles-Body-Body1">
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyE-Column1-Body1">AddUserAttribute(UserAttributeType type, string id, string label, string description, bool persistent, UserAttributeRequiredForConnectionType connectionType)</td>
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyD-Column1-Body1" style="font-weight: normal;">This method is called by the main driver class to add a user attribute to the existing list of user attributes. The id of the user attribute must be unique.<br /><br /> 

This method will trigger a user attribute changed event to applications. </td>
                                                    </tr>
                                                    <tr class="TableStyle-TP-Global-Table-Styles-Body-Body1">
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyE-Column1-Body1">AddUserAttribute(UserAttributeType type, string id, string label, string description, bool persistent, UserAttributeRequiredForConnectionType connectionType, UserAttributeDataType dataType, string defaultValue)</td>
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyD-Column1-Body1">This method is called by the main driver class to add a user attribute to the existing list of user attributes. This is an overload of the above method that accepts User attribute data type and default value in addition to the existing parameters. 

The id of the user attribute must be unique.<br /><br />This method will trigger a user attribute changed event to applications. </td>
                                                    </tr>
                                                    <tr class="TableStyle-TP-Global-Table-Styles-Body-Body1">
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyE-Column1-Body1">AddUserAttribute(UserAttributeType type, string id, string label, string description, bool persistent, UserAttributeRequiredForConnectionType connectionType, 

UserAttributeDataType dataType, string defaultValue, string defaultValueLabel)

</td>
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyD-Column1-Body1">This method is called by the main driver class to add a user attribute to the existing list of user attributes. This is an overload of the above method that accepts default value label in addition to the existing parameters. 

The id of the user attribute must be unique. 
<br /><br />This method will trigger user attribute changed event to applications. </td>
                                                    </tr>
                                                    <tr class="TableStyle-TP-Global-Table-Styles-Body-Body1">
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyE-Column1-Body1">ModifyUserAttribute(string id, string description)</td>
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyD-Column1-Body1">This method is called by the main driver class to update description of an existing user attribute. 

This method will trigger user attribute changed events to applications. </td>
                                                    </tr>
                                                    <tr class="TableStyle-TP-Global-Table-Styles-Body-Body1">
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyE-Column1-Body1">ModifyUserAttribute(string id, string description,string defaultValue)</td>
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyD-Column1-Body1">This method is called by the main driver class to update description or default value of an existing user attribute. 

<br /><br />This method will trigger user attribute changed events to applications. </td>
                                                    </tr>
                                                    <tr class="TableStyle-TP-Global-Table-Styles-Body-Body1">
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyB-Column1-Body1">RaiseUserAttributesChangedEvent(List&lt;UserAttribute&gt; userAttributes)</td>
                                                        <td class="TableStyle-TP-Global-Table-Styles-BodyA-Column1-Body1">This method is called explicitly by the main driver class to notify user attribute changes whenever required.</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <h2>Sample Driver Implementation</h2>
                                            <p>This section demonstrates the use of IBasicInformation3 for a simple driver that inherits the ABasicDriver class.</p>
                                            <p>As an example, assume that this driver generates a security code at runtime which has to be entered on the device to start communication.</p>
                                            <p>To create a driver, first create a SIMPL#Pro library project from the available projects in Visual Studio.</p>
                                            <p>
                                                <img src="../Resources/Images/Gateway_2.png" style="width: 400px;" />
                                            </p>
                                            <p>Next, add a reference to <strong>RADCommon.dll </strong>and inherit ABasicDriver on the main driver class to get access to user attributes for modification.</p>
                                            <p class="codeboxshade">public class SampleDriver : ABasicDriver<br />{<br /><span class="indent">private const string SecurityCodeAttributeId = "securityCodeId";<br />private const string SecurityCodeDescription = "Please enter the security code on the device console to start communication.";<br />private const string SecurityCodeLabel = "Security Code";<br /><br />private void OnSecurityCodeChanged(object sender, SecurityCodeChangedEventArgs args)<br />{<br /><span class="indent2">AddOrUpdateSecurityUserAttribute(args.SecurityCode);</span>}<br /><br />private void OnDeviceCommunicated(object sender, EventArgs args)<br />{<br /><span class="indent2">RemoveSecurityCodeUserAttribute();</span>}<br /><br />public override void ConvertJsonFileToDriverData(string jsonString)<br />{<br /><br />}<br /><br />public override CType AbstractClassType<br />{<br /><span class="indent2">get { return typeof (SampleDriver); }</span>}<br /><br />private void AddOrUpdateSecurityUserAttribute(string securityCode)<br />{<br /><span class="indent2">IEnumerable&lt;UserAttribute&gt; userAttributes = RetrieveUserAttributes();<br />UserAttribute securityCodeAttribute = userAttributes.FirstOrDefault(x =&gt; x.ParameterId == SecurityCodeAttributeId);<br /><br />if (securityCodeAttribute == null)<br />{<br /><span class="indent">AddUserAttribute(UserAttributeType.Custom, SecurityCodeAttributeId, SecurityCodeLabel, SecurityCodeDescription, true,<br />UserAttributeRequiredForConnectionType.Before, UserAttributeDataType.String, securityCode);</span>}<br />else<br />{<br /><span class="indent">ModifyUserAttribute(SecurityCodeAttributeId, SecurityCodeDescription, securityCode);</span>}</span>}<br /><br />private void RemoveSecurityCodeUserAttribute()<br />{<br /><span class="indent2">RemoveUserAttribute(SecurityCodeAttributeId);</span>}</span>}</p>
                                        </div>
                                        <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TPSkin_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                            <div class="button-group-container-left">
                                                <button class="button needs-pie previous-topic-button" title="Previous page">
                                                    <img alt="Navigate previous" src="../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                </button>
                                                <button class="button needs-pie next-topic-button" title="Next page">
                                                    <img alt="Navigate next" src="../../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>